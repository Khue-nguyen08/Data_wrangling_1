Data Tidy
================

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Let’s import a dataset

``` r
litters_df = 
  read_csv("data/FAS_litters.csv")
```

    ## Rows: 49 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): Group, Litter Number, GD0 weight, GD18 weight
    ## dbl (4): GD of Birth, Pups born alive, Pups dead @ birth, Pups survive
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pup_df = 
  read_csv (
    "data/FAS_pups.csv", 
    skip = 3,
    na = c ("NA", ".", "")
  )
```

    ## Rows: 313 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Litter Number
    ## dbl (5): Sex, PD ears, PD eyes, PD pivot, PD walk
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
getwd()
```

    ## [1] "C:/Users/khueb/OneDrive/Documents/Biostat_Mailman/Data Science I/Data_wrangling_1"

``` r
mlb_df =
   read_excel("data/mlb11.xlsx")
```

Import LotR word counts

``` r
fortr_df =
  read_excel("data/LotR_Words.xlsx", range = "B3:D6")
```

Import the PULSE

``` r
pulse_df = 
  read_sas ("data/public_pulse_data.sas7bdat")
```

What about data exporting

``` r
write_csv(pup_df, "pup.csv")
```

``` r
options(tibble.print_min = 3)
litters_df = 
  read_csv("./data/FAS_litters.csv", na = c("NA", ".", ""))
```

    ## Rows: 49 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (2): Group, Litter Number
    ## dbl (6): GD0 weight, GD18 weight, GD of Birth, Pups born alive, Pups dead @ ...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Note: wide data often grouped by a character as a column. A long format
separate this grouped character out and list it as repeated variable.
human readability vs computer readability Relational data: tables are
combined by joins Inner joins: taking the same input, remove the
unmatched outer joins: including left, right, full Left: including the
first data set, add-on the matched ones from the second one Right:
including the second one Full: including all the data, put NA on the
unmatched ones Combining multiple tables: bind_rows; \*\_join \## Pivot
longer

``` r
options(tibble.print_min = 5)
pulse_df = 
  read_sas ("data/public_pulse_data.sas7bdat") |>
  janitor::clean_names() |>
  pivot_longer(
    cols = bdi_score_bl : bdi_score_12m, # this columns has the names and has the values
    names_to = "visit",
    values_to = "bdi_score",
    names_prefix = "bdi_score_"
  ) |>
  mutate (visit = replace( visit, visit == "bl", "00m")) |>
  relocate (id, visit)
```

Do one more example

``` r
litters_df = 
  read_csv("./data/FAS_litters.csv", na = c("NA", ".", "")) |>
  janitor:: clean_names() |>
  pivot_longer(
    cols= gd0_weight:gd18_weight, 
    names_to = "gd_time",
    values_to = "weight",
  ) |>
  mutate(gd_time = case_match(
    gd_time,
    "gd0_weight" ~ 0,
    "gd18_weight" ~ 18
  ))
```

    ## Rows: 49 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (2): Group, Litter Number
    ## dbl (6): GD0 weight, GD18 weight, GD of Birth, Pups born alive, Pups dead @ ...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Pivot wider

Make up a table

``` r
analysis_df =
  tibble( group = c ("treatment", "treatment", "control","control"),
          time = c("pre", "post", "pre", "post"),
          mean = c (4,10,2.5,5))
```

Pivot it wider When to use the wider: useful to add in the fomrula to
have a new variable. For example to compare pre treatment and post
treatment

``` r
analysis_df |>
  pivot_wider(
    names_from = time,
    values_from = mean,
    
  ) |>
  knitr::kable()
```

| group     | pre | post |
|:----------|----:|-----:|
| treatment | 4.0 |   10 |
| control   | 2.5 |    5 |

## Bind tables

``` r
fellowship_ring = 
  read_excel("data/lotR_Words.xlsx", range = "B3:D6") |>
  mutate( movie = "fellowship_ring")
two_towers = 
  read_excel("data/lotR_Words.xlsx", range = "F3:H6") |>
  mutate (movie = "two_towers")
return_king = 
  read_excel("data/lotR_Words.xlsx", range = "J3:L6") |>
  mutate (movie = "rerurn_king")
lotr_df = 
  bind_rows(fellowship_ring, two_towers, return_king) |>
  pivot_longer(
    cols= Female : Male,
    names_to ="sex",
    values_to = "words"
  ) |>
  relocate(movie) |>
  mutate(Race = str_to_lower(Race),
         sex = str_to_lower(sex))
```

\## Join FAS datasets

``` r
litters_df = 
  read_csv("./data/FAS_litters.csv", na = c("NA", ".", "")) |>
  janitor:: clean_names() |>
  mutate(wt_gain = gd18_weight - gd0_weight) |>
  separate (
    group, into = c ("dose", "day_of_treatment"),sep = 3
  )
```

    ## Rows: 49 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (2): Group, Litter Number
    ## dbl (6): GD0 weight, GD18 weight, GD of Birth, Pups born alive, Pups dead @ ...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Import pups data

``` r
pub_df = 
  read_csv("./data/FAS_pups.csv", na = c ("NA", ".", "")) |>
  janitor:: clean_names()
```

    ## New names:
    ## Rows: 316 Columns: 6
    ## ── Column specification
    ## ──────────────────────────────────────────────────────── Delimiter: "," chr
    ## (6): ...1, 1 = male, 2 = female, ...3, ...4, ...5, ...6
    ## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
    ## Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## • `` -> `...1`
    ## • `` -> `...3`
    ## • `` -> `...4`
    ## • `` -> `...5`
    ## • `` -> `...6`

Join the datasets
